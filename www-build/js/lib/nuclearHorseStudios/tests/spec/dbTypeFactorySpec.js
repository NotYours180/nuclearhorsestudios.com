define(["DbTypeFactory"],function(DbTypeFactory){describe("DbTypeFactory",function(){var factory,$http,type,host,dbName,designDoc;beforeEach(function(){$http={get:function(){},post:function(){},"delete":function(){}},type="blogpost",host="http://nuclearhorsestudios.com",dbName="nuclearhorseblog",designDoc="_design/blog",factory=DbTypeFactory(type,host,dbName,designDoc)($http)}),describe("getAll",function(){it("Calls $http.get with the correct url for all records",function(){spyOn($http,"get").andCallFake(function(url){expect(url).toBe(host+"/"+dbName+"/"+designDoc+"/_view/"+type+"?descending=true")}),factory.getAll()})}),describe("getRecent",function(){it("Calls $http.get with the correct url for the 5 most recent records",function(){spyOn($http,"get").andCallFake(function(url){expect(url).toBe(host+"/"+dbName+"/"+designDoc+"/_view/"+type+"?limit=5&descending=true")}),factory.getRecent(5)})}),describe("getPage",function(){var spy;beforeEach(function(){spy=spyOn($http,"get")}),it("Calls $http.get with the correct url for retrieving the first page, 10 results per page",function(){var expectedUrl=host+"/"+dbName+"/"+designDoc+"/_view/"+type+"?skip=0&limit=10&descending=true";factory.getPage(1,10),expect(spy).toHaveBeenCalledWith(expectedUrl)}),it("Calls $http.get with the correct url for retrieving the third page, 4 results per page",function(){var expectedUrl=host+"/"+dbName+"/"+designDoc+"/_view/"+type+"?skip=8&limit=4&descending=true";factory.getPage(3,4),expect(spy).toHaveBeenCalledWith(expectedUrl)})}),describe("add",function(){it("Calls $http.post with the correct url for adding data",function(){var data={some:"data"},expectedUrl=host+"/"+dbName,httpSpy=spyOn($http,"post");factory.add(data),expect(httpSpy).toHaveBeenCalledWith(expectedUrl,{some:"data"})})}),describe("delete",function(){it("Calls $http.delete with correct url for deleting id 1",function(){var data={_id:1},expectedUrl=host+"/"+dbName+"/"+data._id,httpSpy=spyOn($http,"delete");factory.delete(data),expect(httpSpy).toHaveBeenCalledWith(expectedUrl)})})})});